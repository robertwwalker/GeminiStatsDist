[{"name":"app.R","content":"#| standalone: true\n#| viewerHeight: 800\nlibrary(shiny)\nlibrary(ggplot2)\n\nui <- fluidPage(\n  titlePanel(\"Central Limit Theorem Explorer\"),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"dist\", \"Population Distribution:\",\n                  choices = c(\"Normal\", \"Exponential\", \"Beta\", \"Lognormal\", \n                              \"Binomial\", \"Poisson\", \"Geometric\", \n                              \"Negative Binomial\", \"Chi-square\", \"F\")),\n      uiOutput(\"dist_params\"),\n      hr(),\n      sliderInput(\"n\", \"Sample Size (n):\", min = 1, max = 100, value = 30),\n      sliderInput(\"n_samples\", \"Number of Samples:\", min = 100, max = 5000, value = 1000, step = 100),\n      actionButton(\"resample\", \"Generate New Samples\", class = \"btn-primary\")\n    ),\n    mainPanel(\n      plotOutput(\"distPlot\"),\n      plotOutput(\"samplingPlot\"),\n      verbatimTextOutput(\"stats\")\n    )\n  )\n)\n\nserver <- function(input, output) {\n  \n  # Dynamic UI for distribution parameters\n  output$dist_params <- renderUI({\n    switch(input$dist,\n           \"Normal\" = tagList(numericInput(\"mean\", \"Mean\", 0), numericInput(\"sd\", \"SD\", 1, min = 0.1)),\n           \"Exponential\" = numericInput(\"rate\", \"Rate (lambda)\", 1, min = 0.1),\n           \"Beta\" = tagList(numericInput(\"shape1\", \"Shape 1\", 2), numericInput(\"shape2\", \"Shape 2\", 5)),\n           \"Lognormal\" = tagList(numericInput(\"logmean\", \"Meanlog\", 0), numericInput(\"logsd\", \"SDlog\", 1)),\n           \"Binomial\" = tagList(numericInput(\"size\", \"Size (Trials)\", 10), numericInput(\"prob\", \"Probability\", 0.5, step = 0.1)),\n           \"Poisson\" = numericInput(\"lambda\", \"Lambda\", 4),\n           \"Geometric\" = numericInput(\"g_prob\", \"Probability\", 0.2),\n           \"Negative Binomial\" = tagList(numericInput(\"nb_size\", \"Target Successes\", 5), numericInput(\"nb_prob\", \"Prob\", 0.5)),\n           \"Chi-square\" = numericInput(\"df\", \"Degrees of Freedom\", 3),\n           \"F\" = tagList(numericInput(\"df1\", \"DF 1\", 10), numericInput(\"df2\", \"DF 2\", 20))\n    )\n  })\n  \n  # Reactive logic to generate data\n  get_data <- reactive({\n    input$resample\n    n <- input$n\n    reps <- input$n_samples\n    \n    # Generate the samples based on selection\n    samples <- replicate(reps, {\n      switch(input$dist,\n             \"Normal\" = rnorm(n, input$mean, input$sd),\n             \"Exponential\" = rexp(n, input$rate),\n             \"Beta\" = rbeta(n, input$shape1, input$shape2),\n             \"Lognormal\" = rlnorm(n, input$logmean, input$logsd),\n             \"Binomial\" = rbinom(n, input$size, input$prob),\n             \"Poisson\" = rpois(n, input$lambda),\n             \"Geometric\" = rgeom(n, input$g_prob),\n             \"Negative Binomial\" = rnbinom(n, input$nb_size, input$nb_prob),\n             \"Chi-square\" = rchisq(n, input$df),\n             \"F\" = rf(n, input$df1, input$df2)\n      )\n    })\n    \n    if(n == 1) return(matrix(samples, nrow=1))\n    return(samples)\n  })\n  \n  # Top Plot: Population Distribution\n  output$distPlot <- renderPlot({\n    data <- as.vector(get_data())\n    ggplot(data.frame(x = data), aes(x = x)) +\n      geom_histogram(fill = \"steelblue\", color = \"white\", bins = 30) +\n      labs(title = paste(\"Population Distribution (Individual Observations)\"),\n           subtitle = \"This shows the shape of the data you are sampling from.\") +\n      theme_minimal()\n  })\n  \n# Bottom Plot: Sampling Distribution with Normal Overlay\n  output$samplingPlot <- renderPlot({\n    # Calculate means of each sample\n    sample_means <- colMeans(get_data())\n    df_means <- data.frame(x = sample_means)\n    \n    # Calculate parameters for the overlay curve\n    m_means <- mean(sample_means)\n    s_means <- sd(sample_means)\n    \n    ggplot(df_means, aes(x = x)) +\n      # Use density on y-axis to match the Normal curve scale\n      geom_histogram(aes(y = ..density..), fill = \"darkorange\", \n                     color = \"white\", bins = 30, alpha = 0.7) +\n      # Add the Theoretical Normal Curve\n      stat_function(fun = dnorm, \n                    args = list(mean = m_means, sd = s_means), \n                    color = \"black\", size = 1.2) +\n      geom_vline(xintercept = m_means, linetype = \"dashed\", color = \"red\") +\n      labs(title = \"Sampling Distribution of the Mean\",\n           subtitle = paste(\"Black line: Normal Distribution N(\", \n                            round(m_means, 2), \",\", round(s_means, 2), \")\"),\n           x = \"Sample Mean Value\",\n           y = \"Density\") +\n      theme_minimal()\n  })  \n  output$stats <- renderPrint({\n    means <- colMeans(get_data())\n    cat(\"Theoretical Mean vs Observed Mean:\\n\")\n    cat(\"Mean of Sample Means:\", round(mean(means), 4), \"\\n\")\n    cat(\"SD of Sample Means (Standard Error):\", round(sd(means), 4), \"\\n\")\n  })\n}\n\nshinyApp(ui, server)","type":"text"}]
