[{"name":"app.R","content":"library(shiny)\n\n# --- 1. User Interface (UI) ---\nui <- fluidPage(\n  \n  titlePanel(\"Statistical Distributions Explorer\"),\n  \n  sidebarLayout(\n    sidebarPanel(\n      # Dropdown for Sample Size\n      selectInput(\"n\", \n                  \"Sample Size (n):\", \n                  choices = c(15, 30, 50, 100), \n                  selected = 100),\n      \n      # Dropdown for Distribution Type\n      selectInput(\"dist\", \n                  \"Distribution:\", \n                  choices = c(\"Normal\", \"Binomial\", \"Geometric\", \"Poisson\", \"Uniform\", \"Lognormal\"),\n                  selected = \"Normal\"),\n      \n      tags$hr(),\n      \n      # Dynamic UI: This area will change based on the distribution selected\n      uiOutput(\"dynamic_params\")\n    ),\n    \n    mainPanel(\n      # Output: Histogram\n      plotOutput(\"dist_plot\"),\n      \n      tags$hr(),\n      h4(\"Summary Statistics\"),\n      \n      # Output: Summary Table\n      tableOutput(\"summary_table\")\n    )\n  )\n)\n\n# --- 2. Server Logic ---\nserver <- function(input, output, session) {\n  \n  # Reactive UI: Render input fields based on distribution choice\n  output$dynamic_params <- renderUI({\n    dist <- input$dist\n    \n    if (dist == \"Normal\") {\n      tagList(\n        numericInput(\"mu\", \"Mean (\\U03BC):\", value = 0),\n        numericInput(\"sigma\", \"Standard Deviation (\\U03C3):\", value = 1, min = 0.0001)\n      )\n    } else if (dist == \"Binomial\") {\n      tagList(\n        numericInput(\"size\", \"Number of Trials:\", value = 10, min = 1, step = 1),\n        numericInput(\"prob\", \"Probability of Success (p):\", value = 0.5, min = 0, max = 1, step = 0.1)\n      )\n    } else if (dist == \"Geometric\") {\n      tagList(\n        numericInput(\"prob\", \"Probability of Success (p):\", value = 0.5, min = 0.0001, max = 1, step = 0.1)\n      )\n    } else if (dist == \"Poisson\") {\n      tagList(\n        numericInput(\"lambda\", \"Rate (\\U03BB):\", value = 5, min = 0)\n      )\n    } else if (dist == \"Uniform\") {\n      tagList(\n        numericInput(\"min\", \"Minimum:\", value = 0),\n        numericInput(\"max\", \"Maximum:\", value = 10)\n      )\n    } else if (dist == \"Lognormal\") {\n      tagList(\n        numericInput(\"meanlog\", \"Mean of Log:\", value = 0),\n        numericInput(\"sdlog\", \"SD of Log:\", value = 1, min = 0.0001)\n      )\n    }\n  })\n  \n  # Reactive Data: Generate random sample based on inputs\n  sampled_data <- reactive({\n    # Require the basic inputs to be ready\n    req(input$n, input$dist)\n    n <- as.numeric(input$n)\n    dist <- input$dist\n    \n    # Generate data conditionally, ensuring parameters are loaded first\n    if (dist == \"Normal\") {\n      req(input$mu, input$sigma)\n      rnorm(n, mean = input$mu, sd = input$sigma)\n      \n    } else if (dist == \"Binomial\") {\n      req(input$size, input$prob)\n      rbinom(n, size = input$size, prob = input$prob)\n      \n    } else if (dist == \"Geometric\") {\n      req(input$prob)\n      rgeom(n, prob = input$prob)\n      \n    } else if (dist == \"Poisson\") {\n      req(input$lambda)\n      rpois(n, lambda = input$lambda)\n      \n    } else if (dist == \"Uniform\") {\n      req(input$min, input$max)\n      runif(n, min = input$min, max = input$max)\n      \n    } else if (dist == \"Lognormal\") {\n      req(input$meanlog, input$sdlog)\n      rlnorm(n, meanlog = input$meanlog, sdlog = input$sdlog)\n    }\n  })\n  \n  # Render the Histogram\n  output$dist_plot <- renderPlot({\n    # Get the generated data\n    data <- sampled_data() \n    \n    hist(data, \n         main = paste(\"Histogram of\", input$dist, \"Distribution\"),\n         xlab = \"Value\", \n         col = \"steelblue\", \n         border = \"white\",\n         breaks = 15) # Adjust breaks for better bin sizing at small sample sizes\n  })\n  \n  # Render the Summary Table\n  output$summary_table <- renderTable({\n    data <- sampled_data()\n    \n    # Calculate the five-number summary + mean and SD\n    summary_df <- data.frame(\n      Statistic = c(\"Mean\", \"Standard Deviation\", \"Minimum\", \"1st Quartile (Q1)\", \"Median\", \"3rd Quartile (Q3)\", \"Maximum\"),\n      Value = c(\n        mean(data),\n        sd(data),\n        min(data),\n        quantile(data, 0.25),\n        median(data),\n        quantile(data, 0.75),\n        max(data)\n      )\n    )\n    return(summary_df)\n  }, digits = 4) # Round to 4 decimal places for cleanliness\n}\n\n# --- 3. Run the App ---\nshinyApp(ui = ui, server = server)\n","type":"text"}]
