[{"name":"app.R","content":"library(shiny)\nlibrary(bslib)\n\nui <- page_sidebar(\n  title = \"Advanced Distribution Calculator\",\n  theme = bs_theme(bootswatch = \"yeti\"),\n  \n  sidebar = sidebar(\n    # 1. Distribution Selection\n    selectInput(\"dist\", \"Select Distribution:\",\n                choices = list(\n                  \"Continuous\" = c(\"Normal\", \"t\", \"F\", \"Exponential\", \"Uniform\", \"Beta\"),\n                  \"Discrete\" = c(\"Binomial\", \"Poisson\", \"Negative Binomial\", \"Geometric\")\n                )),\n    \n    hr(),\n    # 2. Dynamic Parameters\n    uiOutput(\"params_ui\"),\n    \n    hr(),\n    # 3. Calculation Logic\n    radioButtons(\"calc_type\", \"Calculation Type:\",\n                 choices = list(\"Find Probability P(X)\" = \"prob\", \n                                \"Find Quantile (x)\" = \"quant\")),\n    \n    numericInput(\"val\", \"Input Value (x or p):\", value = 0.5, step = 0.1),\n    \n    # 4. Tail Switch\n    radioButtons(\"tail\", \"Tail Direction:\",\n                 choices = list(\"Lower Tail (P ≤ x)\" = \"lower\", \n                                \"Upper Tail (P > x)\" = \"upper\"))\n  ),\n  \n  # Results and Plotting\n  layout_column_wrap(\n    width = 1,\n    card(\n      card_header(\"Statistical Result\"),\n      div(style = \"font-size: 2rem; color: #2c3e50; text-align: center; font-weight: bold;\",\n          textOutput(\"result_text\"))\n    ),\n    card(\n      card_header(\"Distribution Visualization\"),\n      plotOutput(\"dist_plot\", height = \"400px\")\n    )\n  )\n)\n\nserver <- function(input, output, session) {\n  \n  # Generate UI based on selection\n  output$params_ui <- renderUI({\n    d <- input$dist\n    if (d == \"Normal\") {\n      tagList(numericInput(\"mu\", \"Mean (μ):\", 0), numericInput(\"sigma\", \"SD (σ):\", 1, min = 0.1))\n    } else if (d == \"t\") {\n      numericInput(\"df\", \"Deg. Freedom (v):\", 10, min = 1)\n    } else if (d == \"F\") {\n      tagList(numericInput(\"df1\", \"df1:\", 10, min = 1), numericInput(\"df2\", \"df2:\", 10, min = 1))\n    } else if (d == \"Exponential\") {\n      numericInput(\"rate\", \"Rate (λ):\", 1, min = 0.01)\n    } else if (d == \"Uniform\") {\n      tagList(numericInput(\"min\", \"Min (a):\", 0), numericInput(\"max\", \"Max (b):\", 1))\n    } else if (d == \"Beta\") {\n      tagList(numericInput(\"s1\", \"Shape 1 (α):\", 2), numericInput(\"s2\", \"Shape 2 (β):\", 2))\n    } else if (d == \"Binomial\") {\n      tagList(numericInput(\"size\", \"Trials (n):\", 20, min = 1), numericInput(\"p_b\", \"Prob (p):\", 0.5, min=0, max=1))\n    } else if (d == \"Poisson\") {\n      numericInput(\"lam\", \"Lambda (λ):\", 5, min = 0)\n    } else if (d == \"Negative Binomial\") {\n      tagList(numericInput(\"nb_size\", \"Successes (r):\", 5), numericInput(\"nb_p\", \"Prob (p):\", 0.5, min=0, max=1))\n    } else if (d == \"Geometric\") {\n      numericInput(\"g_p\", \"Prob (p):\", 0.5, min=0, max=1)\n    }\n  })\n  \n  # Core Calculation\n  calc_val <- reactive({\n    req(input$val)\n    d <- input$dist\n    v <- input$val\n    lt <- (input$tail == \"lower\")\n    is_q <- (input$calc_type == \"quant\")\n    \n    tryCatch({\n      if (d == \"Normal\")      { if(is_q) qnorm(v, input$mu, input$sigma, lower.tail=lt) else pnorm(v, input$mu, input$sigma, lower.tail=lt) }\n      else if (d == \"t\")      { if(is_q) qt(v, input$df, lower.tail=lt) else pt(v, input$df, lower.tail=lt) }\n      else if (d == \"F\")      { if(is_q) qf(v, input$df1, input$df2, lower.tail=lt) else pf(v, input$df1, input$df2, lower.tail=lt) }\n      else if (d == \"Exponential\") { if(is_q) qexp(v, input$rate, lower.tail=lt) else pexp(v, input$rate, lower.tail=lt) }\n      else if (d == \"Uniform\") { if(is_q) qunif(v, input$min, input$max, lower.tail=lt) else punif(v, input$min, input$max, lower.tail=lt) }\n      else if (d == \"Beta\")    { if(is_q) qbeta(v, input$s1, input$s2, lower.tail=lt) else pbeta(v, input$s1, input$s2, lower.tail=lt) }\n      else if (d == \"Binomial\") { if(is_q) qbinom(v, input$size, input$p_b, lower.tail=lt) else pbinom(v, input$size, input$p_b, lower.tail=lt) }\n      else if (d == \"Poisson\")  { if(is_q) qpois(v, input$lam, lower.tail=lt) else ppois(v, input$lam, lower.tail=lt) }\n      else if (d == \"Negative Binomial\") { if(is_q) qnbinom(v, input$nb_size, input$nb_p, lower.tail=lt) else pnbinom(v, input$nb_size, input$nb_p, lower.tail=lt) }\n      else if (d == \"Geometric\") { if(is_q) qgeom(v, input$g_p, lower.tail=lt) else pgeom(v, input$g_p, lower.tail=lt) }\n    }, error = function(e) return(NA))\n  })\n  \n  output$result_text <- renderText({\n    res <- calc_val()\n    if (is.na(res)) return(\"Invalid Calculation\")\n    label <- if(input$calc_type == \"prob\") \"P = \" else \"x = \"\n    paste0(label, round(res, 5))\n  })\n  \n  # Advanced Plotting\n  output$dist_plot <- renderPlot({\n    res <- calc_val()\n    d <- input$dist\n    req(!is.na(res))\n    \n    # Logic to determine x-range and density function\n    is_discrete <- d %in% c(\"Binomial\", \"Poisson\", \"Negative Binomial\", \"Geometric\")\n    \n    if (!is_discrete) {\n      # Continuous Plotting\n      x_min <- if(d==\"Normal\") input$mu - 4*input$sigma else if(d==\"Uniform\") input$min - 0.5 else 0\n      x_max <- if(d==\"Normal\") input$mu + 4*input$sigma else if(d==\"Uniform\") input$max + 0.5 else if(d==\"Beta\") 1 else 10\n      \n      x_seq <- seq(x_min, x_max, length.out = 300)\n      y_seq <- switch(d,\n                      \"Normal\" = dnorm(x_seq, input$mu, input$sigma),\n                      \"t\" = dt(x_seq, input$df),\n                      \"F\" = df(x_seq, input$df1, input$df2),\n                      \"Exponential\" = dexp(x_seq, input$rate),\n                      \"Uniform\" = dunif(x_seq, input$min, input$max),\n                      \"Beta\" = dbeta(x_seq, input$s1, input$s2)\n      )\n      \n      plot(x_seq, y_seq, type=\"l\", lwd=2, col=\"#2c3e50\", xlab=\"x\", ylab=\"Density\", main=paste(d, \"Distribution\"))\n      \n      # Shading the tail\n      x_crit <- if(input$calc_type == \"prob\") input$val else res\n      if(input$tail == \"lower\") {\n        poly_x <- x_seq[x_seq <= x_crit]\n        poly_y <- y_seq[x_seq <= x_crit]\n      } else {\n        poly_x <- x_seq[x_seq >= x_crit]\n        poly_y <- y_seq[x_seq >= x_crit]\n      }\n      polygon(c(min(poly_x), poly_x, max(poly_x)), c(0, poly_y, 0), col=rgb(0.2, 0.6, 0.8, 0.5), border=NA)\n    } else {\n      # Discrete Plotting\n      x_max_d <- if(d==\"Binomial\") input$size else 20\n      x_vals <- 0:x_max_d\n      y_vals <- switch(d,\n                       \"Binomial\" = dbinom(x_vals, input$size, input$p_b),\n                       \"Poisson\" = dpois(x_vals, input$lam),\n                       \"Negative Binomial\" = dnbinom(x_vals, input$nb_size, input$nb_p),\n                       \"Geometric\" = dgeom(x_vals, input$g_p)\n      )\n      \n      cols <- rep(\"#bdc3c7\", length(x_vals))\n      x_crit <- if(input$calc_type == \"prob\") input$val else res\n      if(input$tail == \"lower\") cols[x_vals <= x_crit] <- \"#3498db\"\n      else cols[x_vals > x_crit] <- \"#3498db\"\n      \n      barplot(y_vals, names.arg=x_vals, col=cols, border=\"white\", main=paste(d, \"PMF\"), xlab=\"k\", ylab=\"P(X=k)\")\n    }\n  })\n}\n\nshinyApp(ui, server)","type":"text"}]
