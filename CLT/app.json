[{"name":"app.R","content":"#| standalone: true\n#| viewerHeight: 900\nlibrary(shiny)\n\nui <- fluidPage(\n  titlePanel(\"Central Limit Theorem: Base R Edition\"),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"dist\", \"1. Choose Population Distribution:\",\n                  choices = c(\"Normal\", \"Exponential\", \"Beta\", \"Lognormal\", \n                              \"Binomial\", \"Poisson\", \"Geometric\", \n                              \"Negative Binomial\", \"Chi-square\", \"F\")),\n      \n      # Dynamic UI for parameters\n      uiOutput(\"dist_params\"),\n      \n      hr(),\n      \n      sliderInput(\"n\", \"2. Sample Size (n):\", min = 1, max = 100, value = 30),\n      sliderInput(\"n_samples\", \"3. Number of Samples:\", min = 100, max = 5000, value = 1000, step = 100),\n      sliderInput(\"bins\", \"4. Histogram Bins:\", min = 5, max = 100, value = 30),\n      \n      actionButton(\"resample\", \"Generate New Samples\", class = \"btn-primary\", style=\"width: 100%;\")\n    ),\n    \n    mainPanel(\n      plotOutput(\"distPlot\"),\n      plotOutput(\"samplingPlot\"),\n      wellPanel(\n        h4(\"Statistical Summary\"),\n        verbatimTextOutput(\"stats\")\n      )\n    )\n  )\n)\n\nserver <- function(input, output) {\n  \n  # Reactive UI for distribution-specific parameters\n  output$dist_params <- renderUI({\n    switch(input$dist,\n           \"Normal\" = tagList(numericInput(\"mean\", \"Mean\", 0), numericInput(\"sd\", \"SD\", 1, min = 0.1)),\n           \"Exponential\" = numericInput(\"rate\", \"Rate (lambda)\", 1, min = 0.1),\n           \"Beta\" = tagList(numericInput(\"shape1\", \"Shape 1\", 2), numericInput(\"shape2\", \"Shape 2\", 5)),\n           \"Lognormal\" = tagList(numericInput(\"logmean\", \"Meanlog\", 0), numericInput(\"logsd\", \"SDlog\", 1)),\n           \"Binomial\" = tagList(numericInput(\"size\", \"Trials\", 10), numericInput(\"prob\", \"Prob\", 0.5, step = 0.1)),\n           \"Poisson\" = numericInput(\"lambda\", \"Lambda\", 4),\n           \"Geometric\" = numericInput(\"g_prob\", \"Prob\", 0.2),\n           \"Negative Binomial\" = tagList(numericInput(\"nb_size\", \"Target Successes\", 5), numericInput(\"nb_prob\", \"Prob\", 0.5)),\n           \"Chi-square\" = numericInput(\"df\", \"Degrees of Freedom\", 3),\n           \"F\" = tagList(numericInput(\"df1\", \"DF 1\", 10), numericInput(\"df2\", \"DF 2\", 20))\n    )\n  })\n  \n  # Generate the data matrix (rows = n, columns = n_samples)\n  get_data <- reactive({\n    input$resample # Trigger on button click\n    n <- input$n\n    reps <- input$n_samples\n    \n    samples <- replicate(reps, {\n      switch(input$dist,\n             \"Normal\" = rnorm(n, req(input$mean), req(input$sd)),\n             \"Exponential\" = rexp(n, req(input$rate)),\n             \"Beta\" = rbeta(n, req(input$shape1), req(input$shape2)),\n             \"Lognormal\" = rlnorm(n, req(input$logmean), req(input$logsd)),\n             \"Binomial\" = rbinom(n, req(input$size), req(input$prob)),\n             \"Poisson\" = rpois(n, req(input$lambda)),\n             \"Geometric\" = rgeom(n, req(input$g_prob)),\n             \"Negative Binomial\" = rnbinom(n, req(input$nb_size), req(input$nb_prob)),\n             \"Chi-square\" = rchisq(n, req(input$df)),\n             \"F\" = rf(n, req(input$df1), req(input$df2))\n      )\n    })\n    return(samples)\n  })\n  \n  # Top Plot: Population Distribution (Single observations)\n  output$distPlot <- renderPlot({\n    raw_data <- as.vector(get_data())\n    hist(raw_data, breaks = input$bins, col = \"skyblue\", border = \"white\",\n         main = \"Population Distribution\", \n         xlab = \"Value of Individual Observations\",\n         cex.main = 1.5)\n  })\n  \n  # Bottom Plot: Sampling Distribution with Normal Overlay\n  output$samplingPlot <- renderPlot({\n    means <- colMeans(get_data())\n    \n    # Calculate histogram\n    h <- hist(means, breaks = input$bins, plot = FALSE)\n    \n    # Plot histogram with probability=TRUE to allow density overlay\n    hist(means, breaks = input$bins, col = \"orange\", border = \"white\",\n         prob = TRUE, main = \"Sampling Distribution of the Mean\",\n         xlab = \"Sample Mean Value\", cex.main = 1.5)\n    \n    # Add Theoretical Normal Curve\n    x_fit <- seq(min(means), max(means), length = 100)\n    y_fit <- dnorm(x_fit, mean = mean(means), sd = sd(means))\n    lines(x_fit, y_fit, col = \"black\", lwd = 3)\n    \n    # Add Mean line\n    abline(v = mean(means), col = \"red\", lwd = 2, lty = 2)\n    \n    legend(\"topright\", legend=c(\"Observed Means\", \"Normal Curve\"),\n           fill=c(\"orange\", NA), border=c(\"white\", NA), \n           lty=c(NA, 1), lwd=c(NA, 3), bty=\"n\")\n  })\n  \n  # Summary Statistics\n  output$stats <- renderPrint({\n    means <- colMeans(get_data())\n    cat(\"Summary of Sample Means:\\n\")\n    print(summary(means))\n    cat(\"\\nStandard Error (SD of Means):\", round(sd(means), 4))\n  })\n}\n\nshinyApp(ui, server)","type":"text"}]
