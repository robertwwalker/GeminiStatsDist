[{"name":"app.R","content":"library(shiny)\n\n# --- 1. User Interface (UI) ---\nui <- fluidPage(\n  \n  titlePanel(\"Statistical Distributions Explorer\"),\n  \n  sidebarLayout(\n    sidebarPanel(\n      # Dropdown for Sample Size\n      selectInput(\"n\", \n                  \"Sample Size (n):\", \n                  choices = c(15, 30, 50, 100, 500, 1000), \n                  selected = 100),\n      \n      # Dropdown for Distribution Type\n      selectInput(\"dist\", \n                  \"Distribution:\", \n                  choices = c(\"Normal\", \"Binomial\", \"Geometric\", \"Negative Binomial\", \"Poisson\", \"Uniform\", \"Lognormal\"),\n                  selected = \"Normal\"),\n      \n      # Slider for number of Histogram Bins\n      sliderInput(\"bins\",\n                  \"Number of Bins:\",\n                  min = 5,\n                  max = 50,\n                  value = 15),\n      \n      tags$hr(),\n      \n      # Dynamic UI: Changes based on distribution\n      uiOutput(\"dynamic_params\")\n    ),\n    \n    mainPanel(\n      # Output: Side-by-side plots (made slightly taller for better viewing)\n      plotOutput(\"dist_plot\", height = \"400px\"),\n      \n      tags$hr(),\n      h4(\"Summary Statistics\"),\n      \n      # Output: Summary Table\n      tableOutput(\"summary_table\")\n    )\n  )\n)\n\n# --- 2. Server Logic ---\nserver <- function(input, output, session) {\n  \n  # Reactive UI: Render input fields based on distribution choice\n  output$dynamic_params <- renderUI({\n    dist <- input$dist\n    \n    if (dist == \"Normal\") {\n      tagList(\n        numericInput(\"mu\", \"Mean (\\U03BC):\", value = 0),\n        numericInput(\"sigma\", \"Standard Deviation (\\U03C3):\", value = 1, min = 0.0001)\n      )\n    } else if (dist == \"Binomial\") {\n      tagList(\n        numericInput(\"size\", \"Number of Trials:\", value = 10, min = 1, step = 1),\n        numericInput(\"prob\", \"Probability of Success (p):\", value = 0.5, min = 0, max = 1, step = 0.1)\n      )\n    } else if (dist == \"Geometric\") {\n      tagList(\n        numericInput(\"geom_prob\", \"Probability of Success (p):\", value = 0.5, min = 0.0001, max = 1, step = 0.1)\n      )\n    } else if (dist == \"Negative Binomial\") {\n      tagList(\n        numericInput(\"nbinom_size\", \"Target Number of Successes (r):\", value = 5, min = 1, step = 1),\n        numericInput(\"nbinom_prob\", \"Probability of Success (p):\", value = 0.5, min = 0.0001, max = 1, step = 0.1)\n      )\n    } else if (dist == \"Poisson\") {\n      tagList(\n        numericInput(\"lambda\", \"Rate (\\U03BB):\", value = 5, min = 0)\n      )\n    } else if (dist == \"Uniform\") {\n      tagList(\n        numericInput(\"min\", \"Minimum:\", value = 0),\n        numericInput(\"max\", \"Maximum:\", value = 10)\n      )\n    } else if (dist == \"Lognormal\") {\n      tagList(\n        numericInput(\"meanlog\", \"Mean of Log:\", value = 0),\n        numericInput(\"sdlog\", \"SD of Log:\", value = 1, min = 0.0001)\n      )\n    }\n  })\n  \n  # Reactive Data: Generate random sample\n  sampled_data <- reactive({\n    req(input$n, input$dist)\n    n <- as.numeric(input$n)\n    dist <- input$dist\n    \n    if (dist == \"Normal\") {\n      req(input$mu, input$sigma)\n      rnorm(n, mean = input$mu, sd = input$sigma)\n    } else if (dist == \"Binomial\") {\n      req(input$size, input$prob)\n      rbinom(n, size = input$size, prob = input$prob)\n    } else if (dist == \"Geometric\") {\n      req(input$geom_prob)\n      rgeom(n, prob = input$geom_prob)\n    } else if (dist == \"Negative Binomial\") {\n      req(input$nbinom_size, input$nbinom_prob)\n      rnbinom(n, size = input$nbinom_size, prob = input$nbinom_prob)\n    } else if (dist == \"Poisson\") {\n      req(input$lambda)\n      rpois(n, lambda = input$lambda)\n    } else if (dist == \"Uniform\") {\n      req(input$min, input$max)\n      runif(n, min = input$min, max = input$max)\n    } else if (dist == \"Lognormal\") {\n      req(input$meanlog, input$sdlog)\n      rlnorm(n, meanlog = input$meanlog, sdlog = input$sdlog)\n    }\n  })\n  \n  # Render the Side-by-Side Plots\n  output$dist_plot <- renderPlot({\n    data <- sampled_data() \n    dist <- input$dist\n    \n    # --- Establish consistent X-axis limits for visual comparison ---\n    x_min <- min(data)\n    x_max <- max(data)\n    \n    if (dist == \"Normal\") {\n      req(input$mu, input$sigma)\n      x_min <- min(x_min, input$mu - 3.5 * input$sigma)\n      x_max <- max(x_max, input$mu + 3.5 * input$sigma)\n    } else if (dist == \"Binomial\") {\n      req(input$size)\n      x_min <- 0\n      x_max <- input$size\n    } else if (dist == \"Geometric\") {\n      req(input$geom_prob)\n      x_min <- 0\n      x_max <- max(x_max, qgeom(0.99, input$geom_prob))\n    } else if (dist == \"Negative Binomial\") {\n      req(input$nbinom_size, input$nbinom_prob)\n      x_min <- 0\n      x_max <- max(x_max, qnbinom(0.99, size = input$nbinom_size, prob = input$nbinom_prob))\n    } else if (dist == \"Poisson\") {\n      req(input$lambda)\n      x_min <- 0\n      x_max <- max(x_max, qpois(0.999, lambda = input$lambda))\n    } else if (dist == \"Uniform\") {\n      req(input$min, input$max)\n      x_min <- input$min\n      x_max <- input$max\n    } else if (dist == \"Lognormal\") {\n      req(input$meanlog, input$sdlog)\n      x_min <- 0\n      x_max <- max(x_max, qlnorm(0.98, meanlog = input$meanlog, sdlog = input$sdlog))\n    }\n    \n    # Set up plotting area for 1 row, 2 columns\n    par(mfrow = c(1, 2), mar = c(5, 4, 4, 2) + 0.1)\n    \n    # --- PLOT 1: Empirical Sample Histogram ---\n    hist(data, \n         main = paste(\"Sample Histogram (n =\", input$n, \")\"),\n         xlab = \"Value\", \n         ylab = \"Frequency (Count)\",\n         col = \"steelblue\", \n         border = \"white\",\n         breaks = input$bins, \n         xlim = c(x_min, x_max),\n         freq = TRUE) # Standard count histogram\n    \n    # --- PLOT 2: Theoretical PDF / PMF ---\n    if (dist %in% c(\"Normal\", \"Uniform\", \"Lognormal\")) {\n      # Continuous distributions -> PDF Curve\n      x_seq <- seq(x_min, x_max, length.out = 500)\n      \n      if (dist == \"Normal\") {\n        y_vals <- dnorm(x_seq, mean = input$mu, sd = input$sigma)\n      } else if (dist == \"Uniform\") {\n        y_vals <- dunif(x_seq, min = input$min, max = input$max)\n      } else if (dist == \"Lognormal\") {\n        y_vals <- dlnorm(x_seq, meanlog = input$meanlog, sdlog = input$sdlog)\n      }\n      \n      plot(x_seq, y_vals, type = \"l\", col = \"darkorange\", lwd = 3,\n           main = \"Theoretical PDF (\\U221E Sample)\",\n           xlab = \"Value\", ylab = \"Probability Density\",\n           xlim = c(x_min, x_max))\n      \n    } else {\n      # Discrete distributions -> PMF Lollipop plot\n      x_vals <- max(0, floor(x_min)):ceiling(x_max)\n      \n      if (dist == \"Binomial\") {\n        y_vals <- dbinom(x_vals, size = input$size, prob = input$prob)\n      } else if (dist == \"Geometric\") {\n        y_vals <- dgeom(x_vals, prob = input$geom_prob)\n      } else if (dist == \"Negative Binomial\") {\n        y_vals <- dnbinom(x_vals, size = input$nbinom_size, prob = input$nbinom_prob)\n      } else if (dist == \"Poisson\") {\n        y_vals <- dpois(x_vals, lambda = input$lambda)\n      }\n      \n      plot(x_vals, y_vals, type = \"h\", col = \"darkorange\", lwd = 3,\n           main = \"Theoretical PMF (\\U221E Sample)\",\n           xlab = \"Value\", ylab = \"Probability Mass\",\n           xlim = c(x_min, x_max))\n      points(x_vals, y_vals, col = \"darkorange\", pch = 16, cex = 1.5)\n    }\n  })\n  \n  # Render the Summary Table\n  output$summary_table <- renderTable({\n    data <- sampled_data()\n    \n    summary_df <- data.frame(\n      Statistic = c(\"Mean\", \"Standard Deviation\", \"Minimum\", \"1st Quartile (Q1)\", \"Median\", \"3rd Quartile (Q3)\", \"Maximum\"),\n      Value = c(mean(data), sd(data), min(data), quantile(data, 0.25), median(data), quantile(data, 0.75), max(data))\n    )\n    return(summary_df)\n  }, digits = 4)\n}\n\n# --- 3. Run the App ---\nshinyApp(ui = ui, server = server)","type":"text"}]
